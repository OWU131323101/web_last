# 宇宙ステーション(ISS) コミュニケーション & 観測システム
## プロジェクト概要
本プロジェクトは、**「宇宙との交信と体験」**をテーマにしたインタラクティブなWebアプリケーションです。
国際宇宙ステーション（ISS）の現在地をリアルタイムで追跡しながら、船外活動を行う「宇宙飛行士」や、特定の条件下で遭遇する「未確認生命体（エイリアン）」とAIを通じたチャットでコミュニケーションをとることができます。
また、スマートフォンをコントローラーとして使用し、加速度センサー等の値をリアルタイムでPC画面（デスクトップ）に同期させることで、直感的な操作体験を提供します。

---

## 📂 ファイル構成と役割

プロジェクトの主要なディレクトリ構成は以下の通りです。

```text
Web_last/
├── server.js            # [Back-end] メインサーバーファイル
│                        #  - APIサーバー (Express)
│                        #  - リアルタイム通信 (Socket.IO)
│                        #  - AIレスポンス生成 (OpenAI / Gemini API連携)
│
├── public/              # [Front-end] クライアントからアクセスされる静的ファイル群
│   ├── index.html       #  - メイン画面（PC/デスクトップ向け）
│   ├── smart.html       #  - スマホコントローラー画面
│   ├── css/             #  - デザイン・スタイル定義
│   └── js/
│       ├── main.js      #  - アプリケーションロジック（Socket通信、UI操作）
│       ├── sketch.js    #  - ビジュアル描画 (p5.js等による描画処理)
│       └── sensors.js   #  - スマホセンサーデータ取得モジュール
│
├── prompt.md            # [AI Persona] システムプロンプト：宇宙飛行士・職員
├── prompt_alien.md      # [AI Persona] システムプロンプト：異星人（UFO遭遇時）
├── .env                 # [Config] APIキー設定ファイル (Git管理外)
└── package.json         # [Node.js] パッケージ管理ファイル
```

---

## 🚀 実行方法 (Node.js サーバー版)

本システムはNode.jsサーバー上で動作します。

### 1. 環境設定
プロジェクトのルートディレクトリに `.env` ファイルを作成し、必要なAPIキーを設定します。

```env
# .env ファイルの例
OPENAI_API_KEY=sk-... (あなたのAPIキー)
# または
GEMINI_API_KEY=...
PORT=8080
```

### 2. 依存パッケージのインストール
初回のみ、以下のコマンドでライブラリをインストールします。

```bash
npm install
```

### 3. サーバー起動
以下のコマンドでサーバーを立ち上げます。

```bash
node server.js
```

### 4. アプリケーションへのアクセス
ブラウザ（Chrome推奨）を開き、以下のURLにアクセスします。

*   **メイン画面 (PC):** `http://localhost:8080/`
*   **コントローラー (スマホ):**
    *   メイン画面に表示されるQRコードを読み取るか、
    *   同じWi-Fi内のスマホから `http://[PCのIPアドレス]:8080/smart` へアクセス

---

## 🛠 機能要件・技術解説

本システムは、以下の技術要素を組み合わせて構築されています。

### 1. リアルタイム通信システム (Socket.IO)
*   **概要:** サーバーと複数のクライアント（PC、スマホ）間で、遅延の少ない双方向通信を実現しています。
*   **用途:**
    *   **チャット同期:** スマホから送信したメッセージをPC画面にも即座に表示。
    *   **センサー連動:** スマホの傾きや動き（ジャイロ/加速度センサー）データをPCへ転送し、コンテンツ操作に反映。

### 2. AIチャットボット (生成AI API連携)
*   **概要:** ユーザーの入力に対し、設定された「ペルソナ」になりきって応答します。
*   **動的ペルソナ切り替え:**
    *   **通常時:** `prompt.md` を読み込み、ISS滞在中のクルーとして振る舞います。
    *   **UFO遭遇時:** 特定の操作（UFOとのアラインメント等）が満たされると、参照プロンプトを `prompt_alien.md` に切り替え、謎の宇宙人としての会話モードへ移行します。
*   **技術:** サーバーサイド (`server.js`) でプロンプトエンジニアリング処理を行い、Gemini または OpenAI API へリクエストを送信しています。

### 3. ISS トラッキング (External API)
*   **概要:** 外部の公開APIから国際宇宙ステーションの緯度・経度情報を定期的に取得し、画面上に現在位置を表示します。
*   **実装:** `main.js` 内でポーリング処理（一定間隔でのデータ取得）を行っています。

---

## 🎓 授業・発表でのポイント
*   **相互作用 (Interaction):** 単に見るだけでなく、スマホを使うことで「参加」できる体験型Webシステムであることを強調。
*   **技術の統合:** モダンなWeb技術（Socket.IO, 生成AI, センサーAPI）を一つの作品として統合している点。
*   **演出:** 状況に応じたAIの性格変化（宇宙飛行士⇔宇宙人）による、エンターテイメント性の高さ。
